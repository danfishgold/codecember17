<!doctype html>
<head>
  <title>Magnets</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<style>
  svg text {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    
    cursor: default;
  }

  body, svg {
    padding: 0;
    margin: 0;
  }
</style>
<body>
  <div id="main"></div>
  <script src="elm.js"></script>
  <script>
    
    var node = document.getElementById('main')
    var app = Elm.Main.embed(node)
    

    var parseMouse = function(e) {
      return {
        pointer: [e.clientX, e.clientY],
        ctrlDown: e.ctrlKey
      }
    }

    var parseTouch = function(e) {
      return {
        pointer: [e.changedTouches[0].clientX, e.changedTouches[0].clientY],
        ctrlDown: e.ctrlKey
      }
    }

    node.addEventListener('mousedown', function(e) {
      // console.log('mouse down', e)
      app.ports.mouseDown.send(parseMouse(e))
      e.stopPropagation()
    })

    node.addEventListener('mousemove', function(e) {
      // console.log('mouse move', e)
      app.ports.mouseMove.send(parseMouse(e))
      e.stopPropagation()
    })

    node.addEventListener('mouseup', function(e) {
      // console.log('mouse up', e)
      app.ports.mouseUp.send(parseMouse(e))
      e.stopPropagation()
    })
    
    node.addEventListener('touchstart', function(e) {
      // console.log('touch start', e)
      app.ports.touchStart.send(parseTouch(e))
      e.stopPropagation()
      e.preventDefault()
    })

    node.addEventListener('touchmove', function(e) {
      // console.log('touch move', e)
      app.ports.touchMove.send(parseTouch(e))
      e.stopPropagation()
      e.preventDefault()
    })

    node.addEventListener('touchend', function(e) {
      // console.log('touch end', e)
      app.ports.touchEnd.send(parseTouch(e))
      e.stopPropagation()
      e.preventDefault()
    })

    node.addEventListener('touchcancel', function(e) {
      // console.log('touch cancel', e)
      app.ports.touchCancel.send(parseTouch(e))
      e.stopPropagation()
      e.preventDefault()
    })

    </script>
  </body>